resources:
- ../openstack-resource-controller/default

images:
- name: controller
  newName: {{ openstack_resource_controller_image }}
  newTag: {{ openstack_resource_controller_image_tag }}

patches:
  - target:
      kind: Deployment
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/resources/limits/memory
        value: 256Mi
{% if openstack_resource_controller_node_selector %}
  - target:
      kind: Deployment
    patch: |-
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: placeholder
      spec:
        template:
          spec:
            nodeSelector:
{{ openstack_resource_controller_node_selector | to_nice_yaml | indent(14, first=True) }}
{% endif %}
